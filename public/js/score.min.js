(function() {
    var i = window,
        n = document,
        u = function(n, t) {
            return n.classList ? n.classList.contains(t) : !!n.className.match(new RegExp("(\\s|^)" + t + "(\\s|$)"))
        },
        r = function(n, t) {
            n.classList ? n.classList.add(t) : u(n, t) || (n.className += " " + t)
        },
        t = function(n, t) {
            if (n.classList) n.classList.remove(t);
            else if (u(n, t)) {
                var i = new RegExp("(\\s|^)" + t + "(\\s|$)");
                n.className = n.className.replace(i, " ")
            }
        },
        l = function(t) {
            var i = n.createElement("link");
            i.type = "text/css";
            i.rel = "stylesheet";
            i.href = t;
            n.head.appendChild(i)
        },
        a = function() {
            var t = n.querySelector('head>meta[name="viewport"]');
            t == null && (t = n.createElement("meta"), t.setAttribute("name", "viewport"), n.head.appendChild(t));
            t.setAttribute("content", "width=device-width, initial-scale=1.0")
        },
        f = document.querySelector('script[src*="/score."]').getAttribute("src"),
        v = function(n) {
            typeof screen.orientation == "object" && typeof screen.orientation.lock == "function" && screen.orientation.lock(n).catch(function(n) {
                console.error(n)
            })
        },
        o = function() {
            n.fullscreenElement || n.documentElement.requestFullscreen && n.documentElement.requestFullscreen().catch(n => {
                console.error("requestFullscreen", n)
            });
            n.removeEventListener("click", o)
        },
        e = function(t, i) {
            var r = n.createElement(t);
            return typeof i == "object" && i != null && Object.keys(i).forEach(n => {
                r.setAttribute(n, i[n])
            }), r
        },
        y = function() {
            var f = e("div", {
                    id: "gv_overlay"
                }),
                i = e("div", {
                    id: "gv_playmenu"
                });
            i.innerHTML = '<a class="gv_amenu" >❯<\/a><a class="gv_aback gv_item">Thoát game<\/a><a class="gv_areload gv_item">Tải lại game<\/a><a class="gv_aclose gv_item">Đóng lại<\/a>';
            n.body.appendChild(f);
            n.body.appendChild(i);
            var o = n.querySelector(".gv_amenu"),
                s = n.querySelector(".gv_aback"),
                h = n.querySelector(".gv_areload"),
                c = n.querySelector(".gv_aclose");
            n.addEventListener("click", function(n) {
                !i.contains(n.target) && u(i, "gv_show") && t(i, "gv_show")
            });
            o.addEventListener("click", function() {
                u(i, "gv_show") || r(i, "gv_show")
            });
            h.addEventListener("click", function() {
                t(i, "gv_show");
                window.location.replace(window.location.href)
            });
            c.addEventListener("click", function() {
                t(i, "gv_show")
            });
            s.addEventListener("click", function() {
                t(i, "gv_show");
                try {
                    window.opener != null && window.close()
                } catch (n) {
                    console.error(n)
                }
                var r = document.referrer.length > 0 && document.referrer.indexOf("gamevui") > 0 && document.referrer != location.href ? document.referrer : "https://gamevui.vn";
                window.location = r
            })
        },
        p = function() {
            try {
                return window.self !== window.top
            } catch (n) {
                return !0
            }
        },
        s = 0,
        w = function() {
            var t = e("div", {
                "class": "gv_orientation-alert"
            });
            t.innerHTML = '<div class="orientation-alert-main"><div class="gv_rotate-landscape"><\/div><a class="gv_rotate-title"><span>Bạn vui lòng xoay màn hình<\/span><\/a><a class="gv_rotate-close"><span>Bỏ qua<\/span><\/a><\/div>';
            t.addEventListener("click", function() {
                r(t, "hide");
                s = 1
            });
            n.body.appendChild(t);
            h();
            i.onorientationchange = h;
            n.addEventListener("fullscreenchange", () => {
                n.fullscreenElement && f.indexOf("rotate=1") > 0 && Math.abs(window.orientation) != 90 && v("landscape")
            })
        },
        b = /android|blackberry|iphone|ipad/i.test(navigator.userAgent),
        h = function() {
            var u = n.querySelector(".gv_orientation-alert");
            s == 0 && (navigator.userAgent.match(/(iPod|iPhone|iPad)/i) && !!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/i) ? Math.abs(window.orientation) == 90 ? r(u, "hide") : t(u, "hide") : i.addEventListener("resize", function() {
                var n = i.innerWidth > i.innerHeight ? 90 : 0;
                Math.abs(n) == 90 ? r(u, "hide") : t(u, "hide")
            }))
        },
        c = function(n, t, i, r, u) {
            var f = new XMLHttpRequest;
            return f.withCredentials = !0, f.open(t, n), f.onload = function() {
                typeof i == "function" && i(f.response)
            }, f.onerror = function(n) {
                typeof r == "function" && r("Lỗi", n)
            }, typeof u != "undefined" ? (f.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"), f.send(u)) : f.send(), f
        };
    i.RC4 = function() {
        function u(t) {
            for (var u = 0, f, e = t.length, r = 0; r <= 255; r++) i[r] = t[r % e], n[r] = r;
            for (r = 0; r <= 255; r++) u = (u + n[r] + i[r]) % 256, f = n[r], n[r] = n[u], n[u] = f
        }

        function r(t, i) {
            var e, l;
            u(i);
            var r = 0,
                f = 0,
                o = [],
                s, h, c;
            for (e = 0; e < t.length; e++) r = (r + 1) % 256, f = (f + n[r]) % 256, h = n[r], n[r] = n[f], n[f] = h, l = (n[r] + n[f]) % 256, s = n[l], c = t[e] ^ s, o.push(c);
            return o
        }

        function f(n) {
            for (var i = "", r = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "a", "b", "c", "d", "e", "f"], t = 0; t < n.length; t++) i += r[n[t] >> 4] + r[n[t] & 15];
            return i
        }

        function e(n) {
            for (var i = [], t = n.substr(0, 2) == "0x" ? 2 : 0; t < n.length; t += 2) i.push(parseInt(n.substr(t, 2), 16));
            return i
        }

        function o(n) {
            for (var i = "", t = 0; t < n.length; t++) i += String.fromCharCode(n[t]);
            return i
        }

        function t(n) {
            for (var i = [], t = 0; t < n.length; t++) i.push(n.charCodeAt(t));
            return i
        }
        var n = [],
            i = [];
        this.encrypt = function(n, i) {
            var u = t(n),
                e = t(i),
                o = r(u, e);
            return f(o)
        };
        this.decrypt = function(n, i) {
            var u = e(n),
                f = t(i),
                s = r(u, f);
            return o(s)
        }
    };
    i.GV = function() {
        var s = (new RC4).decrypt("cf666b52c23d4510b86242a739ed86e41dcb32", "abcdeghiklmnopqrstuvxy"),
            h = "https://gamevui.vn/account/login?returnurl=https://gamevui.vn/games/services/score.htm",
            l = "https://gamevui.vn/games/services/getuserinfo.aspx",
            a = "https://gamevui.vn/games/services/sendscore.aspx",
            f = function(t) {
                if (t.data && t.data.sentinel == "score" && t.data.type === "login") {
                    var r = n.querySelector(".gv_button.gv_btn-submit"),
                        u = new MouseEvent("click");
                    r.dispatchEvent(u)
                }
                i.removeEventListener("message", f)
            },
            o;
        i.addEventListener("message", f, !1);
        o = function(f, e) {
            var o = n.querySelector(".gv_button.gv_btn-submit"),
                v = n.querySelector(".gv_dialog #gv_message.gv_message"),
                p = n.querySelector(".gv_footer .gv_btn-close"),
                y = n.querySelector(".gv_dialog .gv_body .gv_loginbox");
            c(l, "POST", function(n) {
                var w = (new DOMParser).parseFromString("<data>" + n + "<\/data>", "text/xml"),
                    g = w.querySelector("key"),
                    b = w.querySelector("username"),
                    l, k, d;
                t(o, "gv_hide");
                b == null || b.textContent == "" ? (u(y, "gv_hide") && t(y, "gv_hide"), i.open(h)) : (l = f + ":" + e, k = s + g.textContent, l = (new RC4).encrypt(l, k), d = "s=" + l, c(a, "POST", function(n) {
                    try {
                        var i = (new DOMParser).parseFromString("<data>" + n + "<\/data>", "text/xml"),
                            u = i.querySelector("message");
                        $status = i.querySelector("status");
                        v.innerHTML = u.textContent;
                        $status.textContent != "not_authenticated" ? r(y, "gv_hide") : t(o, "gv_hide")
                    } catch (f) {
                        console.error(f);
                        v.innerHTML = "Gửi điểm không thành công.<br/>Vui lòng thử lại sau!"
                    }
                }, function(n, t) {
                    console.error(n, t);
                    v.innerHTML = "Gửi điểm không thành công.<br/>Vui lòng thử lại sau!"
                }, d), r(o, "gv_hide"), setTimeout(function() {
                    t(p, "gv_hide")
                }, 3e3))
            }, function(n, i) {
                console.error(n, i);
                v.innerHTML = "Gửi điểm không thành công!<br/>Xin vui lòng thử lại sau.";
                r(o, "gv_hide");
                setTimeout(function() {
                    t(p, "gv_hide")
                }, 3e3)
            })
        };
        this.saveScore = function(i, u) {
            var c, f, l, v, h, y, s;
            if (i = parseInt(i), c = new URLSearchParams(location.search).get("gid"), c == "") {
                console.log("Chưa xác định được gid");
                return
            }
            if (f = n.querySelector("#gv_savescore"), f == null && (f = e("div", {
                    id: "gv_savescore",
                    "class": "gv_reset"
                }), f.innerHTML = '<div class="gv_dialog"><div class="gv_header"><a class="gv_logo" target="_blank" href="https://gamevui.vn"><\/a><a class="gv_btn-close">x Đóng lại<\/a><\/div><div class="gv_body"><div class="gv_loginbox gv_hide"><p class="gv_message">Bạn cần đăng nhập để lưu điểm<\/p><\/div><div id="gv_message" class="gv_message"><message>Bạn chưa đăng nhập vào hệ thống!<\/message><\/div><\/div><div class="gv_footer"><a class="gv_button gv_btn-fb gv_hide">Khoe điểm<\/a><a class="gv_button gv_btn-close gv_hide">Đóng lại<\/a><a class="gv_button gv_btn-submit gv_hide">Gửi điểm<\/a><\/div><\/div>', n.body.appendChild(f)), l = n.querySelector(".gv_dialog #gv_message.gv_message"), i > 0) l.innerHTML = "Điểm bạn đạt được là <strong class='gv_score'>" + i + "<\/strong>";
            else {
                l.innerHTML = "Bạn chưa ghi được điểm nào";
                return
            }
            var p = n.querySelector(".gv_header .gv_btn-close"),
                w = n.querySelector(".gv_footer .gv_btn-close"),
                a = n.querySelector(".gv_button.gv_btn-submit");
            p.addEventListener("click", function() {
                f.remove();
                typeof u == "function" && u()
            });
            w.addEventListener("click", function() {
                f.remove();
                typeof u == "function" && u()
            });
            /http(s)*:\/\/(gamevui.com|choigame.vn|gamevui.vn)\/(.+)game/.test(document.referrer + "") && (v = "Hoan hô, bạn vừa đạt được " + i + " điểm", h = document.referrer + "", h = h.split("?")[0], y = "https://www.facebook.com/sharer/sharer.php?app_id=260579587419564&u=" + encodeURIComponent(h) + "&display=popup&quote=" + encodeURIComponent(v) + "&redirect_uri=https://gamevui.vn/games/services/close.htm", s = n.querySelector(".gv_button.gv_btn-fb"), t(s, "gv_hide"), s.setAttribute("target", "_blank"), s.setAttribute("href", y), s.addEventListener("click", function() {
                setTimeout(function() {
                    r(s, "gv_hide");
                    t($btnclose, "gv_hide")
                }, 3e3)
            }));
            t(a, "gv_hide");
            a.addEventListener("click", function() {
                o(c, i)
            })
        }
    };
    l("https://gamevui.vn/games/services/score.min.css?v=201220");
    a();
    n.addEventListener("DOMContentLoaded", function() {
        b && (f.indexOf("menu=0") < 0 && y(), f.indexOf("fullscreen=0") < 0 && n.addEventListener("click", o), f.indexOf("mode=") < 0 && f.indexOf("rotate=1") > 0 && w());
        p() && i.addEventListener("keydown", function(n) {
            [40, 38, 32, 8].indexOf(n.keyCode) >= 0 && ["INPUT", "TEXTAREA"].indexOf(n.target.tagName) < 0 && n.preventDefault()
        })
    })
})(),
function(n, t, i, r, u, f, e) {
    n.GoogleAnalyticsObject = u;
    n[u] = n[u] || function() {
        (n[u].q = n[u].q || []).push(arguments)
    };
    n[u].l = 1 * new Date;
    f = t.createElement(i);
    e = t.getElementsByTagName(i)[0];
    f.async = 1;
    f.src = r;
    e.parentNode.insertBefore(f, e)
}(window, document, "script", "https://www.google-analytics.com/analytics.js", "ga");
ga("create", "UA-1035222-27", "auto");
ga("send", "pageview");
document.addEventListener("DOMContentLoaded", function() {
    function y() {
        var r = document.createElement("div"),
            u, n, f;
        r.id = "adsLoadingAdvertising";
        i = document.createElement("div");
        i.id = "adsContainer";
        u = document.createElement("a");
        u.id = "adsStart";
        u.innerText = "Bắt đầu";
        n = document.createElement("a");
        n.id = "adsclose";
        n.title = "Đóng quảng cáo";
        n.className = "gv_hide";
        n.innerHTML = "✖ Bỏ qua";
        n.addEventListener("click", t);
        i.appendChild(n);
        i.appendChild(u);
        r.appendChild(i);
        document.body.appendChild(r);
        f = function() {
            r.className = "adsloading adsima";
            u.parentNode.removeChild(u);
            setTimeout(function() {
                w()
            }, 789);
            r.removeEventListener("click", f)
        };
        r.addEventListener("click", f);
        a()
    }

    function p() {
        r = new google.ima.AdDisplayContainer(document.getElementById("adsContainer"))
    }

    function w() {
        if (typeof google != "object" || typeof google.ima != "object") {
            t();
            return
        }
        c = window.setTimeout(function() {
            document.getElementById("adsLoadingAdvertising") != null && (t(), console.log("Timeout"))
        }, 6e4);
        p();
        r.initialize();
        o = new google.ima.AdsLoader(r);
        o.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, b, !1);
        o.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, l, !1);
        var n = new google.ima.AdsRequest;
        n.adTagUrl = h;
        console.log(n.adTagUrl);
        u = i.clientWidth;
        f = i.clientHeight;
        n.linearAdSlotWidth = u;
        n.linearAdSlotHeight = f;
        n.nonLinearAdSlotWidth = u;
        n.nonLinearAdSlotHeight = f;
        try {
            o.requestAds(n);
            window.setTimeout(function() {
                var n = document.getElementById("adsclose");
                n != null && (n.className = "")
            }, 5e3)
        } catch (e) {
            t();
            console.log(e);
            (new Image).src = "https://bit.ly/2UlS54o"
        }(new Image).src = "https://bit.ly/2WMVJ6a"
    }

    function b(i) {
        var r = new google.ima.AdsRenderingSettings;
        r.restoreCustomPlaybackStateOnAdBreakComplete = !0;
        n = i.getAdsManager(v, r);
        n.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, l);
        n.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, d);
        n.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED, g);
        n.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED, e);
        n.addEventListener(google.ima.AdEvent.Type.USER_CLOSE, e);
        n.addEventListener(google.ima.AdEvent.Type.LOADED, e);
        n.addEventListener(google.ima.AdEvent.Type.STARTED, e);
        n.addEventListener(google.ima.AdEvent.Type.COMPLETE, e);
        try {
            n.init(u, f, google.ima.ViewMode.NORMAL);
            n.start();
            console.log("adsManager.start()", u + "," + f)
        } catch (o) {
            t();
            console.log(o)
        }
    }

    function e(n) {
        var i = n.getAd();
        switch (n.type) {
            case google.ima.AdEvent.Type.LOADED:
                i.isLinear() || console.log("!ad.isLinear()");
                break;
            case google.ima.AdEvent.Type.STARTED:
                i.isLinear();
                break;
            case google.ima.AdEvent.Type.COMPLETE:
            case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:
                i.isLinear();
                t();
                break;
            case google.ima.AdEvent.Type.USER_CLOSE:
                i.isLinear();
                t()
        }
        console.log(n.type)
    }

    function l(n) {
        t();
        (new Image).src = "https://bit.ly/2UlS54o";
        var i = n.getError();
        typeof i == "object" && (console.log(i), k(i.o, i.l, i.h))
    }

    function k(n, t, i) {
        typeof ga == "function" && ga("send", "event", n, t, i)
    }

    function d() {}

    function g() {
        t();
        console.log("onContentResumeRequested")
    }

    function t() {
        try {
            n && n.destroy && n.destroy();
            r && r.destroy && r.destroy()
        } catch (t) {
            console.log(t)
        }
        document.getElementById("adsLoadingAdvertising") != null && document.getElementById("adsLoadingAdvertising").parentNode.removeChild(document.getElementById("adsLoadingAdvertising"));
        clearTimeout(c)
    }
    var n, o, r, v = {},
        c, u, f, i, h, s, a;
    h = "https://pubads.g.doubleclick.net/gampad/ads?iu=/71161633/GAMEV_gamevui/video&description_url=https%3A%2F%2Fgamevui.vn%2Fshinchan-dat-bom%2Fgame&tfcd=0&npa=0&sz=300x169%7C400x300%7C640x480&min_ad_duration=0&max_ad_duration=60000&gdfp_req=1&output=vast&unviewed_position_start=1&env=vp&impl=s&correlator=";
    typeof URLSearchParams == "function" && (s = new URLSearchParams(window.location.search).get("adtagurl"), s != null && s.length > 10 && (h = s));
    a = function() {
        (function(n, t, i) {
            var r, u = n.getElementsByTagName(t)[0];
            n.getElementById(i) || (r = n.createElement(t), r.id = i, r.async = !0, r.src = "//imasdk.googleapis.com/js/sdkloader/ima3.js", u.parentNode.insertBefore(r, u))
        })(document, "script", "ima3")
    };
    (/android|iphone/i.test(navigator.userAgent) || /gamevui.com|choigame.vn|gamevui.vn/.test(document.referrer + "") == !1) && window.location.search.indexOf("ads=0") < 0 && y()
});